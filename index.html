<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>📚 忘れ物防止システム Pro</title>
<meta name="theme-color" content="#007bff">
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  darkMode: 'class',
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#eff6ff',
          500: '#3b82f6',
          600: '#2563eb',
          700: '#1d4ed8',
        }
      },
      animation: {
        'pulse-soft': 'pulse 0.6s ease-in-out',
      }
    }
  }
}
</script>
<link rel="stylesheet" href="css/custom.css">

<!-- ダークモード初期化スクリプト -->
<script>
if (localStorage.getItem('dark-mode') === 'true' ||
   (!('dark-mode' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
  document.documentElement.classList.add('dark');
} else {
  document.documentElement.classList.remove('dark');
}
</script>

</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">
<div class="max-w-lg mx-auto p-2 sm:p-4">

<!-- ヘッダー -->
<header class="bg-gradient-to-r from-blue-600 to-blue-700 dark:from-blue-700 dark:to-blue-800 text-white p-4 sm:p-6 rounded-xl text-center mb-4 shadow-lg">
  <div class="flex justify-between items-center mb-2">
    <h1 class="text-xl sm:text-2xl font-bold">📚 忘れ物防止システム Pro</h1>
    <!-- ダークモード切り替えボタン -->
    <button id="theme-toggle" class="p-2 rounded-lg bg-white/20 hover:bg-white/30 transition-colors duration-200">
      <svg id="theme-toggle-dark-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20">
        <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
      </svg>
      <svg id="theme-toggle-light-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
      </svg>
    </button>
  </div>
  <p class="text-blue-100 dark:text-blue-200">教材・持ち物をまとめて管理！</p>
</header>

<!-- タブナビゲーション -->
<nav class="flex bg-white dark:bg-gray-800 rounded-lg mb-4 overflow-hidden shadow-md">
  <button class="tab-btn flex-1 py-3 px-2 text-xs sm:text-sm font-medium transition-all duration-200 bg-blue-600 text-white" data-tab="quick">⚡ クイック</button>
  <button class="tab-btn flex-1 py-3 px-2 text-xs sm:text-sm font-medium transition-all duration-200 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" data-tab="scanner">📱 登録</button>
  <button class="tab-btn flex-1 py-3 px-2 text-xs sm:text-sm font-medium transition-all duration-200 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" data-tab="items">📋 一覧</button>
  <button class="tab-btn flex-1 py-3 px-2 text-xs sm:text-sm font-medium transition-all duration-200 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" data-tab="check">✅ チェック</button>
  <button class="tab-btn flex-1 py-3 px-2 text-xs sm:text-sm font-medium transition-all duration-200 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" data-tab="settings">⚙️ 設定</button>
</nav>

<!-- クイックアクセスタブ -->
<div id="quick" class="tab-content">
  <div class="grid grid-cols-3 gap-2 sm:gap-4 mb-4">
    <div class="bg-white dark:bg-gray-800 rounded-xl p-3 sm:p-4 text-center shadow-md">
      <div class="text-2xl sm:text-3xl font-bold text-blue-600 dark:text-blue-400" id="total-items">0</div>
      <div class="text-xs sm:text-sm text-gray-600 dark:text-gray-400 mt-1">総アイテム</div>
    </div>
    <div class="bg-white dark:bg-gray-800 rounded-xl p-3 sm:p-4 text-center shadow-md">
      <div class="text-2xl sm:text-3xl font-bold text-green-600 dark:text-green-400" id="checked-items">0</div>
      <div class="text-xs sm:text-sm text-gray-600 dark:text-gray-400 mt-1">チェック済</div>
    </div>
    <div class="bg-white dark:bg-gray-800 rounded-xl p-3 sm:p-4 text-center shadow-md">
      <div class="text-2xl sm:text-3xl font-bold text-purple-600 dark:text-purple-400" id="today-items">0</div>
      <div class="text-xs sm:text-sm text-gray-600 dark:text-gray-400 mt-1">今日の予定</div>
    </div>
  </div>

  <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 mb-4 shadow-md">
    <h3 class="text-lg font-semibold mb-4 flex items-center"><span class="mr-2">🚀</span>クイック追加</h3>
    <div class="flex gap-2 mb-3">
      <input type="text" id="quick-name" placeholder="アイテム名を入力" class="flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-base">
      <button id="quick-add" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors duration-200 whitespace-nowrap">➕ 追加</button>
    </div>
    <div class="flex gap-2 items-center">
      <select id="quick-category" class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
        <option value="教材">📚 教材</option>
        <option value="文房具">✏️ 文房具</option>
        <option value="体育用品">⚽ 体育用品</option>
        <option value="弁当・水筒">🍱 弁当・水筒</option>
        <option value="その他">📦 その他</option>
      </select>
      <button id="quick-scan" class="px-3 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-medium transition-colors duration-200 text-sm">📷 スキャン追加</button>
    </div>
  </div>

  <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 shadow-md">
    <h3 class="text-lg font-semibold mb-4 flex items-center"><span class="mr-2">📅</span>今日のチェックリスト</h3>
    <ul id="today-checklist" class="space-y-2"></ul>
  </div>
</div>

<!-- スキャンタブ（登録用） -->
<div id="scanner" class="tab-content hidden">
  <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 mb-4 shadow-md">
    <div id="viewport" class="relative w-full h-64 border-2 border-blue-600 dark:border-blue-400 rounded-xl overflow-hidden bg-black mb-4">
      <div class="guide absolute top-[20%] left-[15%] right-[15%] bottom-[20%] border-4 border-dashed border-green-400 bg-green-400/10 pointer-events-none rounded-lg"></div>
    </div>
    <div id="status" class="p-3 rounded-lg mb-4 text-center font-medium bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-700">📷 準備完了 - スキャン開始ボタンを押してください</div>
    <div class="text-center">
      <button id="scan-btn" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors duration-200 mr-2">🚀 スキャン開始</button>
      <button id="stop-btn" class="px-6 py-3 bg-gray-600 text-white rounded-lg font-semibold transition-colors duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>⏹ 停止</button>
    </div>
  </div>

  <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 shadow-md">
    <h3 class="text-lg font-semibold mb-4 flex items-center"><span class="mr-2">📖</span>詳細登録</h3>

    <div class="mb-4">
      <label class="block text-sm font-medium mb-2">アイテム名 *</label>
      <input type="text" id="detail-name" placeholder="例: 数学の教科書" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
      <div>
        <label class="block text-sm font-medium mb-2">カテゴリー</label>
        <select id="detail-category" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
          <option value="教材">📚 教材</option>
          <option value="文房具">✏️ 文房具</option>
          <option value="体育用品">⚽ 体育用品</option>
          <option value="弁当・水筒">🍱 弁当・水筒</option>
          <option value="制服・服装">👔 制服・服装</option>
          <option value="楽器">🎵 楽器</option>
          <option value="部活用品">🏃 部活用品</option>
          <option value="その他">📦 その他</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium mb-2">重要度</label>
        <select id="detail-priority" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
          <option value="普通">普通</option>
          <option value="重要">⭐ 重要</option>
          <option value="必須">‼️ 必須</option>
        </select>
      </div>
    </div>

    <div class="mb-4">
      <label class="block text-sm font-medium mb-2">バーコード (任意)</label>
      <input type="text" id="detail-code" placeholder="バーコードまたは独自ID" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
    </div>

    <div class="mb-4">
      <label class="block text-sm font-medium mb-2">メモ (任意)</label>
      <textarea id="detail-memo" rows="2" placeholder="追加情報やメモ" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"></textarea>
    </div>

    <div class="mb-6">
      <label class="block text-sm font-medium mb-2">必要な曜日</label>
      <div class="grid grid-cols-4 sm:grid-cols-7 gap-2">
        <label class="flex items-center space-x-1"><input type="checkbox" value="月" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">月</span></label>
        <label class="flex items-center space-x-1"><input type="checkbox" value="火" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">火</span></label>
        <label class="flex items-center space-x-1"><input type="checkbox" value="水" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">水</span></label>
        <label class="flex items-center space-x-1"><input type="checkbox" value="木" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">木</span></label>
        <label class="flex items-center space-x-1"><input type="checkbox" value="金" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">金</span></label>
        <label class="flex items-center space-x-1"><input type="checkbox" value="土" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">土</span></label>
        <label class="flex items-center space-x-1"><input type="checkbox" value="日" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">日</span></label>
      </div>
    </div>

    <button id="add-detail" class="w-full py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-colors duration-200">➕ 詳細登録</button>
  </div>
</div>

<!-- 一覧タブ -->
<div id="items" class="tab-content hidden">
  <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 mb-4 shadow-md">
    <div class="relative mb-4">
      <input type="text" id="search-input" placeholder="🔍 アイテムを検索..." class="w-full pl-3 pr-10 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
      <button id="search-clear" class="absolute right-2 top-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 text-lg hidden">×</button>
    </div>

    <div class="flex flex-wrap gap-2 mb-4" id="category-tabs">
      <button class="category-btn px-3 py-1 border-2 border-blue-600 bg-blue-600 text-white rounded-full text-sm font-medium transition-all duration-200" data-category="all">全て</button>
      <button class="category-btn px-3 py-1 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-full text-sm font-medium transition-all duration-200" data-category="教材">📚 教材</button>
      <button class="category-btn px-3 py-1 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-full text-sm font-medium transition-all duration-200" data-category="文房具">✏️ 文房具</button>
      <button class="category-btn px-3 py-1 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-full text-sm font-medium transition-all duration-200" data-category="体育用品">⚽ 体育</button>
      <button class="category-btn px-3 py-1 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-full text-sm font-medium transition-all duration-200" data-category="弁当・水筒">🍱 弁当</button>
      <button class="category-btn px-3 py-1 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-full text-sm font-medium transition-all duration-200" data-category="その他">📦 他</button>
    </div>
  </div>

  <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 shadow-md">
    <h3 id="items-title" class="text-lg font-semibold mb-4">📚 全アイテム (0件)</h3>
    <ul id="items-list" class="space-y-3"></ul>
    <div class="text-center mt-4 space-x-2">
      <button id="sort-toggle" class="px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded-lg text-sm font-medium transition-colors duration-200">📊 並び替え</button>
      <button id="clear-items" class="px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm font-medium transition-colors duration-200">🗑 全削除</button>
    </div>
  </div>
</div>

<!-- チェックタブ -->
<div id="check" class="tab-content hidden">
  <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 mb-4 shadow-md">
    <h3 class="text-lg font-semibold mb-4 flex items-center"><span class="mr-2">✅</span>曜日別チェックリスト</h3>
    <div class="grid grid-cols-4 sm:grid-cols-7 gap-2 mb-4" id="preset-days">
      <button class="preset-btn py-2 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-lg font-medium transition-all duration-200 text-center" data-day="月">月</button>
      <button class="preset-btn py-2 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-lg font-medium transition-all duration-200 text-center" data-day="火">火</button>
      <button class="preset-btn py-2 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-lg font-medium transition-all duration-200 text-center" data-day="水">水</button>
      <button class="preset-btn py-2 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-lg font-medium transition-all duration-200 text-center" data-day="木">木</button>
      <button class="preset-btn py-2 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-lg font-medium transition-all duration-200 text-center" data-day="金">金</button>
      <button class="preset-btn py-2 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-lg font-medium transition-all duration-200 text-center" data-day="土">土</button>
      <button class="preset-btn py-2 border-2 border-blue-600 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-50 dark:hover:bg-gray-700 rounded-lg font-medium transition-all duration-200 text-center" data-day="日">日</button>
    </div>
  </div>

  <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 shadow-md">
    <h3 class="text-lg font-semibold mb-4 flex items-center"><span class="mr-2">📷</span>チェック方法選択</h3>
    <div class="flex bg-gray-100 dark:bg-gray-700 rounded-lg mb-4 overflow-hidden border border-gray-300 dark:border-gray-600">
      <button class="scan-mode-btn flex-1 py-2 px-4 font-medium transition-all duration-200 bg-blue-600 text-white" data-mode="manual">✋ 手動チェック</button>
      <button class="scan-mode-btn flex-1 py-2 px-4 font-medium transition-all duration-200 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600" data-mode="scan">📱 スキャンチェック</button>
    </div>

    <!-- 手動チェックモード -->
    <div id="manual-check-mode">
      <div id="check-progress" class="text-center my-4 font-semibold"></div>
      <ul id="checklist" class="space-y-3"></ul>
      <div class="text-center mt-4 space-x-2">
        <button id="check-all" class="px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors duration-200">✅ 全選択</button>
        <button id="uncheck-all" class="px-3 py-1 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg text-sm font-medium transition-colors duration-200">⭕ 全解除</button>
        <button id="reset-check" class="px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded-lg text-sm font-medium transition-colors duration-200">🔄 リセット</button>
      </div>
    </div>

    <!-- スキャンチェックモード -->
    <div id="scan-check-mode" class="hidden">
      <div id="check-viewport" class="relative w-full h-64 border-2 border-blue-600 dark:border-blue-400 rounded-xl overflow-hidden bg-black mb-4">
        <div class="guide absolute top-[20%] left-[15%] right-[15%] bottom-[20%] border-4 border-dashed border-green-400 bg-green-400/10 pointer-events-none rounded-lg"></div>
      </div>
      <div id="check-status" class="p-3 rounded-lg mb-4 text-center font-medium bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-700">📷 バーコードを読み取って自動チェック</div>
      <div class="text-center mb-4">
        <button id="check-scan-btn" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors duration-200 mr-2">🚀 スキャン開始</button>
        <button id="check-stop-btn" class="px-6 py-3 bg-gray-600 text-white rounded-lg font-semibold transition-colors duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>⏹ 停止</button>
      </div>
      <div id="check-result" class="check-result hidden p-4 rounded-lg mb-4 text-center font-semibold"></div>

      <!-- スキャンモードでも共通のチェック状況表示 -->
      <div class="mt-4">
        <div id="scan-check-progress" class="text-center my-4 font-semibold"></div>
        <ul id="scan-checklist" class="space-y-3"></ul>
        <div class="text-center mt-4 space-x-2">
          <button id="scan-check-all" class="px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors duration-200">✅ 全選択</button>
          <button id="scan-uncheck-all" class="px-3 py-1 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg text-sm font-medium transition-colors duration-200">⭕ 全解除</button>
          <button id="scan-reset-check" class="px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded-lg text-sm font-medium transition-colors duration-200">🔄 リセット</button>
        </div>
      </div>

      <div class="mt-8">
        <h4 class="text-lg font-semibold mb-3">📊 スキャン結果</h4>
        <ul id="scan-results" class="space-y-2"></ul>
      </div>
    </div>
  </div>
</div>

<!-- 設定タブ -->
<div id="settings" class="tab-content hidden">
  <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 mb-4 shadow-md">
    <h3 class="text-lg font-semibold mb-4 flex items-center"><span class="mr-2">📊</span>統計情報</h3>
    <div class="grid grid-cols-2 sm:grid-cols-4 gap-4" id="detailed-stats">
      <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 rounded-xl p-4 text-center">
        <div class="text-2xl font-bold text-blue-600 dark:text-blue-400" id="stat-total">0</div>
        <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">総アイテム数</div>
      </div>
      <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/30 rounded-xl p-4 text-center">
        <div class="text-2xl font-bold text-green-600 dark:text-green-400" id="stat-categories">0</div>
        <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">カテゴリー数</div>
      </div>
      <div class="bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/30 dark:to-purple-800/30 rounded-xl p-4 text-center">
        <div class="text-2xl font-bold text-purple-600 dark:text-purple-400" id="stat-barcodes">0</div>
        <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">バーコード付き</div>
      </div>
      <div class="bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/30 dark:to-orange-800/30 rounded-xl p-4 text-center">
        <div class="text-2xl font-bold text-orange-600 dark:text-orange-400" id="stat-completion">0%</div>
        <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">完了率</div>
      </div>
    </div>
  </div>

  <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 mb-4 shadow-md">
    <h3 class="text-lg font-semibold mb-4 flex items-center"><span class="mr-2">⚙️</span>データ管理</h3>
    <div class="grid grid-cols-2 gap-2 mb-4">
      <button id="export-btn" class="py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors duration-200">⬇ エクスポート</button>
      <label for="import-file" class="py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors duration-200 cursor-pointer text-center flex items-center justify-center">⬆ インポート</label>
    </div>
    <input type="file" id="import-file" class="hidden" accept="application/json">
    <div class="grid grid-cols-2 gap-2">
      <button id="backup-btn" class="py-3 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-medium transition-colors duration-200">💾 バックアップ</button>
      <button id="restore-btn" class="py-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg font-medium transition-colors duration-200">🔄 復元</button>
    </div>
    <div id="status-msg" class="mt-4 text-center font-semibold"></div>
  </div>

  <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 shadow-md">
    <h3 class="text-lg font-semibold mb-4 flex items-center"><span class="mr-2">📱</span>PWA情報</h3>
    <p class="text-gray-600 dark:text-gray-400 mb-3">このアプリはPWA対応で以下の機能があります：</p>
    <ul class="list-disc list-inside text-gray-600 dark:text-gray-400 space-y-1 mb-4">
      <li>オフライン動作</li>
      <li>ホーム画面追加</li>
      <li>データ永続保存</li>
      <li>バーコードチェック</li>
    </ul>
    <button id="install-pwa" class="w-full py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-colors duration-200 hidden">📱 ホーム画面に追加</button>
  </div>
</div>

<!-- 編集モーダル -->
<div id="edit-modal" class="fixed inset-0 bg-black/50 z-50 flex justify-center items-center hidden">
  <div class="bg-white dark:bg-gray-800 rounded-xl p-6 max-w-md w-[90%] max-h-[80vh] overflow-y-auto">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-semibold">✏️ アイテム編集</h3>
      <button class="text-2xl hover:text-gray-600 dark:hover:text-gray-400 transition-colors" onclick="closeEditModal()">×</button>
    </div>

    <div class="space-y-4">
      <div>
        <label class="block text-sm font-medium mb-2">アイテム名</label>
        <input type="text" id="edit-name" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
      </div>

      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium mb-2">カテゴリー</label>
          <select id="edit-category" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
            <option value="教材">📚 教材</option>
            <option value="文房具">✏️ 文房具</option>
            <option value="体育用品">⚽ 体育用品</option>
            <option value="弁当・水筒">🍱 弁当・水筒</option>
            <option value="制服・服装">👔 制服・服装</option>
            <option value="楽器">🎵 楽器</option>
            <option value="部活用品">🏃 部活用品</option>
            <option value="その他">📦 その他</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium mb-2">重要度</label>
          <select id="edit-priority" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
            <option value="普通">普通</option>
            <option value="重要">⭐ 重要</option>
            <option value="必須">‼️ 必須</option>
          </select>
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium mb-2">バーコード</label>
        <input type="text" id="edit-code" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
      </div>

      <div>
        <label class="block text-sm font-medium mb-2">メモ</label>
        <textarea id="edit-memo" rows="2" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"></textarea>
      </div>

      <div>
        <label class="block text-sm font-medium mb-2">必要な曜日</label>
        <div id="edit-days" class="grid grid-cols-4 sm:grid-cols-7 gap-2">
          <label class="flex items-center space-x-1"><input type="checkbox" value="月" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">月</span></label>
          <label class="flex items-center space-x-1"><input type="checkbox" value="火" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">火</span></label>
          <label class="flex items-center space-x-1"><input type="checkbox" value="水" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">水</span></label>
          <label class="flex items-center space-x-1"><input type="checkbox" value="木" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">木</span></label>
          <label class="flex items-center space-x-1"><input type="checkbox" value="金" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">金</span></label>
          <label class="flex items-center space-x-1"><input type="checkbox" value="土" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">土</span></label>
          <label class="flex items-center space-x-1"><input type="checkbox" value="日" class="rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"> <span class="text-sm">日</span></label>
        </div>
      </div>

      <div class="flex gap-2 mt-6">
        <button id="save-edit" class="flex-1 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-colors duration-200">💾 保存</button>
        <button onclick="closeEditModal()" class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-semibold transition-colors duration-200">❌ キャンセル</button>
      </div>
    </div>
  </div>
</div>

</div>

<script src="https://unpkg.com/quagga@0.12.1/dist/quagga.min.js"></script>
<script src="js/pwa.js"></script>
<script src="js/database.js"></script>
<script src="js/app.js"></script>
</body>
</html>
